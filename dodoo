#!/usr/bin/env bash
POSITIONAL=()

up() {
    docker-compose run --rm -e DB_NAME="$DBNAME" -p "$PORT":8069 odoo odoo --workers=0 ${QUIET:-} ${POSITIONAL:-}
}

SUBCOMMAND="$1"
shift

while [ $# -gt 0 ]
do
    key="$1"

    case $key in
        -d|--dbname)
            DBNAME="$2"
            shift
            shift
            ;;
        -p|--port)
            PORT="$2"
            shift
            shift
            ;;
        -q|--quiet)
            QUIET='--log-handler=werkzeug:WARNING'
            shift
            ;;
        *)
            POSITIONAL+=("$1")
            shift
            ;;
    esac
done

PORT=${PORT:-'80'}
DBNAME=${DBNAME:-'odoodb'}

case $SUBCOMMAND in
    up)
        up
        ;;
esac
